    {{##
        def.$layout = "article";
        def.title = "Tags";
        def.lead = "All articles sorted by tag."
    #}}

{{
    pagesByTag = {};
    it.$pages.forEach(p => {
        var tags = p.userData.tags;
        if(tags){
            tags.forEach(t => {
                if(!pagesByTag[t]){
                    pagesByTag[t] = [];
                }
                pagesByTag[t].push(p);
            });
        }
    });
}}

{{
    for(var tag in pagesByTag){
        var pages = pagesByTag[tag]; 
}}

<h3 id="{{=tag}}"> {{=tag}} </h3><hr>
<ul>
{{
        for(var i=0; i < pages.length; i++){
            var page = pages[i];
}}
    <li class="text-success"><a href="{{= it.href(page.href) }}">
    <strong>{{= page.userData.title }}</strong> - {{= page.userData.lead }}
    </a></li>
{{
        }
}}
</ul>
{{
    }
}}

